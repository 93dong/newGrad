<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>注册页</title>
  <link rel="stylesheet" href="css/common.css">
  <link rel="stylesheet" href="css/header.css">
  <link rel="stylesheet" href="css/footer.css">
  <link rel="stylesheet" href="css/register.css"/>
  <link rel="stylesheet" href="css/main.css"/>
  <link rel="stylesheet" href="css/index.css"/>
  <style>
    .showmessage{
      width:100%;
      height:300px;
      line-height: 300px;
      text-align: center;
      font-size: 30px;
    }
  </style>
</head>
<body>
<header id="header"></header>
<div id="main">
  <div class="adduser">
    <p class="title" style="font-size: 48px;color: #333333;height: 65px;" >
          用户注册
    </p>
    <div class="showmessage" style="display:none">
      注册成功，请<a href="login.html" style="color: #AB7994">返回登录</a>
    </div>
    <form id="adduser">
      <ul>
        <li>
          <label for="teacherId" >教师Id：</label><input id="teacherId" type="text" name="teacherId" required autofocus />
          <span></span>
        </li>
        <li>
          <label for="unumber" >帐&nbsp;&nbsp;&nbsp;号：</label><input id="unumber" type="text" name="unumber" required />
          <span></span>
        </li>
        <li>
          <label for="uname" >用户名：</label><input id="uname" type="text" name="name" required minlength="2" />
          <span></span>
        </li>

        <li>
          <label for="upwd">密&nbsp;&nbsp;&nbsp;码：</label><input id="upwd" type="pwd" name="age" min="18" max="80"/>
          <span></span>
        </li>
        <li>
          <input id="toBe" type="checkbox" value="1" name="admin" /><label for="toBe">是否申请成为管理员</label>
          <span></span>
        </li>
        <li>
          <p class="rdo">
            <label for="test">验证码：</label><input id="test"  type="text" style="width:70px;"/>  &nbsp;  &nbsp;<img src="data/test.php" alt=""/><a href="#" id="change">看不清？换一张</a>
          </p>
        </li>
      </ul>

    </form>

    <p class="submitBtn"><input id="registerBtn"  disabled type="button" form="adduser" value="提交"/>已有帐号<a href="#">返回登录<a/></p>
  </div>
</div>
<footer id="footer"></footer>

<script src="js/jquery-1.11.3.js"></script>
<script src="js/head.js"></script>
<script src="js/ajax.js"></script>
<script src="js/login.js"></script>
<script>
  $("#teacherId").on("blur",function(){
    var value = $("#teacherId").val();
    var data={};
    data.url = 'data/checkId.php';
    data.params = "teacherId="+value;
    data.successF = function(returnData){
      if(returnData.code ===2){
        $("#teacherId").next("span").text("教师Id有误，请重新输入，或联系管理员");
      }else{
        $("#teacherId").next("span").text("教师id正确，请进行以下注册");
        $("#registerBtn").prop("disabled",false);
      }
    };
    data.errorF = function(){
    };
    CommonAjax.ajax(data);

  });
  $('#registerBtn').on('click',function(){
    var data = $("#adduser").serialize();
    var test=$('#test').val().toUpperCase();
    var check = $("#registerBtn").prop("disabled");
    if(!check){
      $.ajax({
        url:'data/useradd.php',
        data:"test="+test+"&"+data,
        success:function(data){
          if (data.code===1){
            $('.showmessage').show();
            $('#adduser').hide();
          }
        }
      });
    }else{}
  });
  $('.submitBtn').on('click','a',function(){
    location.href='login.html';
  })
</script>

</body>
</html>